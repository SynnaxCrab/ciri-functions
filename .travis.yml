language: node_js

before_install:
  - curl -sfLO https://raw.githubusercontent.com/apex/apex/master/install.sh

install:
  - sh install.sh -b ./bin
  - ./bin/apex version
  - yarn install --cwd ./functions/db-migrations

cache: yarn

deploy:
  provider: script
  script: apex deploy
  skip_cleanup: true
  on:
    branch: master

env:
  global:
    AWS_REGION: us-west-2